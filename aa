public static GroupOperation operatorRoleGroupOperation() {
    return Aggregation.group(CREATED_BY)
            .first(CREATED_BY).as("operatorName")

            // Added - Create action
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(CREATE),
                            ComparisonOperators.Or.or(
                                    ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.PENDING_APPROVAL.getStatus()),
                                    ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.SAVE_PENDING_APPROVAL.getStatus())
                            )
                    ))
                    .then(1).otherwise(0)).as("addedNew")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(CREATE),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.IN_PROGRESS.getStatus())
                    ))
                    .then(1).otherwise(0)).as("addedInProgress")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(CREATE),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.ONHOLD.getStatus())
                    ))
                    .then(1).otherwise(0)).as("addedOnHold")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(CREATE),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.REJECTED.getStatus())
                    ))
                    .then(1).otherwise(0)).as("addedCancelled")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(CREATE),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.APPROVED.getStatus())
                    ))
                    .then(1).otherwise(0)).as("addedCompleted")

            // Changed - Update action
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Or.or(
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Edit"),
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Update")
                            ),
                            ComparisonOperators.Or.or(
                                    ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.PENDING_APPROVAL.getStatus()),
                                    ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.SAVE_PENDING_APPROVAL.getStatus())
                            )
                    ))
                    .then(1).otherwise(0)).as("changedNew")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Or.or(
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Edit"),
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Update")
                            ),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.IN_PROGRESS.getStatus())
                    ))
                    .then(1).otherwise(0)).as("changedInProgress")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Or.or(
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Edit"),
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Update")
                            ),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.ONHOLD.getStatus())
                    ))
                    .then(1).otherwise(0)).as("changedOnHold")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Or.or(
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Edit"),
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Update")
                            ),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.REJECTED.getStatus())
                    ))
                    .then(1).otherwise(0)).as("changedCancelled")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Or.or(
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Edit"),
                                    ComparisonOperators.Eq.valueOf(ACTION).equalToValue("Update")
                            ),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.APPROVED.getStatus())
                    ))
                    .then(1).otherwise(0)).as("changedCompleted")

            // Archived action
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(ReportConstants.AggregateFields.ARCHIVED_ACTION),
                            ComparisonOperators.Or.or(
                                    ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.PENDING_APPROVAL.getStatus()),
                                    ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.SAVE_PENDING_APPROVAL.getStatus())
                            )
                    ))
                    .then(1).otherwise(0)).as("archivedNew")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(ReportConstants.AggregateFields.ARCHIVED_ACTION),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.IN_PROGRESS.getStatus())
                    ))
                    .then(1).otherwise(0)).as("archivedInProgress")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(ReportConstants.AggregateFields.ARCHIVED_ACTION),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.ONHOLD.getStatus())
                    ))
                    .then(1).otherwise(0)).as("archivedOnHold")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(ReportConstants.AggregateFields.ARCHIVED_ACTION),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.REJECTED.getStatus())
                    ))
                    .then(1).otherwise(0)).as("archivedCancelled")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(ReportConstants.AggregateFields.ARCHIVED_ACTION),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.APPROVED.getStatus())
                    ))
                    .then(1).otherwise(0)).as("archivedCompleted")

            // Deleted action
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(DELETE),
                            ComparisonOperators.Or.or(
                                    ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.PENDING_APPROVAL.getStatus()),
                                    ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.SAVE_PENDING_APPROVAL.getStatus())
                            )
                    ))
                    .then(1).otherwise(0)).as("deletedNew")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(DELETE),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.IN_PROGRESS.getStatus())
                    ))
                    .then(1).otherwise(0)).as("deletedInProgress")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(DELETE),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.ONHOLD.getStatus())
                    ))
                    .then(1).otherwise(0)).as("deletedOnHold")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(DELETE),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.REJECTED.getStatus())
                    ))
                    .then(1).otherwise(0)).as("deletedCancelled")
            .sum(ConditionalOperators.when(
                    BooleanOperators.And.and(
                            ComparisonOperators.Eq.valueOf(ACTION).equalToValue(DELETE),
                            ComparisonOperators.Eq.valueOf(APPROVAL_STATUS).equalToValue(ApprovalStatus.APPROVED.getStatus())
                    ))
                    .then(1).otherwise(0)).as("deletedCompleted");
}
